//Blood FX partially based on old NashGore code by Nash Muhandes
Actor GMIDBlood : Blood replaces Blood
{
  Game Doom
  Gravity 0.6
  Scale 0.5
  States
  {
  Spawn:
	TNT1 A 0
	BLSH A 3
	BLSH B 0 A_SpawnDebris("GMIDBlood_Fly",1)
	BLSH B 0 A_SpawnDebris("GMIDBlood_Fly",1)
	BLSH B 3 A_SpawnDebris("GMIDBlood_Fly",1)
	BLSH C 3
	Stop
  }
}

Actor GMIDBloodSplatter : GMIDBlood replaces BloodSplatter {} //You Hexen guys had no idea what you were doing, did you?

Actor GMIDBlood_Fly
{
  Game Doom
  Scale 0.25
  Health 1
  Radius 8
  Height 1
  Mass 5
  +CORPSE
  +NOTELEPORT
  +DONTSPLASH
  +NOBLOCKMAP
  States
  {
  Spawn:
	TNT1 A 0
	TNT1 A 0 A_JumpIf(CallACS("CleanerBlood")==1, "NoThankYou")
	BLDR A 0 A_Jump(128, "AltSpawn")
	BLDR ABCD 3
  LoopingPoint:
	BLDR E 3
	Loop
  AltSpawn:
	BLDR FGHI 3
  AltLoopingPoint:
	BLDR J 3
	Loop
  Crash:
	TNT1 A 0 A_SpawnItem("GMIDBlood_Splatter",0,0,0,1)
	Stop
  NoThankYou:
	TNT1 A 0
	Stop
  }
}

Actor GMIDBlood_Splatter
{
  Game Doom
  Scale 0.25
  Radius 12
  Height 2
  Mass 900000
  +NOTELEPORT
  +DONTSPLASH
  -NOBLOCKMAP
  States
  {
  Spawn:
	TNT1 A 0
	TNT1 A 0 A_PlaySound("blood/splat")
	BLSP ABCDEFGH 1
	Stop
  }
}

actor RibGib
{
  Radius 4
  Height 4
  Speed 0
  Projectile
  -NOGRAVITY
  Gravity 0.5
  health 1
  scale 0.6
  DeathSound "Gib/Land"
  States
  {
  Spawn:
    GRIB ABCD 3
    loop
  Death:
    GRIB EFGHIJKL 3
    stop
  }
}

actor BoneGib : RibGib
{
  States
  {
  Spawn:
    GBON ABCD 3
    loop
  Death:
    GBON EFGHIJKL 3
    stop
  }
}

actor HipGib : RibGib
{
  health 4
  States
  {
  Spawn:
    GHIP ABCD 3
    loop
  Death: //Man, it hurts to be this hip.
    GHIP EFGHIJKL 3
    stop
  }
}
actor GutsGib : RibGib
{
  States
  {
  Spawn:
    GGUT ABCD 3
    loop
  Death:
    GGUT EFGHIJKL 3
    stop
  }
}

actor LimbGib : RibGib
{
  States
  {
  Spawn:
    GLMB ABCD 3
    loop
  Death:
    GLMB EFGHIJKL 3
    stop
  }
}

actor BloodSplurt : RibGib
{
  health 4
  States
  {
  Spawn:
    SPLT ABCD 3
    loop
  Death:
    SPLT EFGHIJKL 3
    stop
  }
}

actor SkullGib : RibGib
{
  States
  {
  Spawn:
    GHED ABCD 3
    loop
  Death:
    GHED EFGHIJKL 3
    stop
  }
}

//These two actors are here to make spawning gib particles much easier and makes the code less cluttered
actor GMIDGibSpawner
{
  States
  {
  Spawn:
  	TNT1 A 0 A_SpawnDebris("SkullGib")
	TNT1 A 0 A_SpawnDebris("RibGib")
	TNT1 A 0 A_SpawnDebris("BoneGib")
	TNT1 A 0 A_SpawnDebris("HipGib")
	TNT1 A 0 A_SpawnDebris("GutsGib")
	TNT1 A 0 A_SpawnDebris("LimbGib")
	TNT1 A 0 A_SpawnDebris("BloodSplurt")
	Stop
  }
}

actor GMIDGibSpawner_NoSkull
{
  States
  {
  Spawn:
	TNT1 A 0 A_SpawnDebris("RibGib")
	TNT1 A 0 A_SpawnDebris("BoneGib")
	TNT1 A 0 A_SpawnDebris("HipGib")
	TNT1 A 0 A_SpawnDebris("GutsGib")
	TNT1 A 0 A_SpawnDebris("LimbGib")
	TNT1 A 0 A_SpawnDebris("BloodSplurt")
	Stop
  }
}

Actor GMIDHeadshotSpawner
{
  States
  {
  Spawn:
	TNT1 AA 0 A_SpawnDebris("BoneGib")
	TNT1 AA 0 A_SpawnDebris("LimbGib")
	TNT1 AA 0 A_SpawnDebris("BloodSplurt")
	Stop
  }
}

Actor GMIDHereticGibSpawner
{
  States
  {
  Spawn:
	TNT1 A 0 A_SpawnDebris("LimbGib")
	TNT1 AA 0 A_SpawnDebris("BloodSplurt")
	Stop
  }
}

//Original spent casing code made by HellCattX and Lippeth
ACTOR CasingSpawner
{
	+MISSILE
	+NOBLOCKMAP
	+NOGRAVITY
	+DROPOFF
	+NOTELEPORT
	+FORCEXYBILLBOARD
	+NOTDMATCH
	+GHOST
	+NOINTERACTION
	Radius 1
	Height 1
	Mass 1
	Damage 0
	Speed 20
	States
	{
	Spawn:
		TNT1 A 0
		TNT1 A 1
		TNT1 A 0 A_CustomMissile("BulletCasing",0,0,random(-80,-100),2,random(45,80))
		TNT1 A 0
		Stop
	}
}

ACTOR BulletCasing
{
   Height 3
   Radius 3
   Speed 2
        Mass 5
   Scale 0.16
   PROJECTILE
   +DOOMBOUNCE
   -NOGRAVITY
        -NOBLOCKMAP
   SeeSound "casings/bullet/bounce"
   States
   {
   Spawn:
      BCAS A 0 A_CustomMissile("CasingSmoketrail",0,0,0)
      BCAS ABCDEFGH 1
      Loop
   Death:
         TNT1 A 0 A_jump(256,"DeadCase1","DeadCase2","DeadCase3","DeadCase4","DeadCase5","DeadCase6")
   DeadCase1:
           BCAS H 350
		   BCAS HHHHHHHHHHH 1 A_FadeOut
           stop
   DeadCase2:
           BCAS I 350
		   BCAS IIIIIIIIIII 1 A_FadeOut
           stop
   DeadCase3:
           BCAS K 350
		   BCAS KKKKKKKKKKK 1 A_FadeOut
           stop
   DeadCase4:
           BCAS J 350
		   BCAS JJJJJJJJJJJ 1 A_FadeOut
           stop
   DeadCase5:
           BCAS K 350
		   BCAS KKKKKKKKKKK 1 A_FadeOut
           stop
   DeadCase6:
           BCAS L 350
		   BCAS LLLLLLLLLLL 1 A_FadeOut
           stop
   }
}

ACTOR ShotgunCasingSpawner : CasingSpawner
{
	States
	{
	Spawn:
		TNT1 A 0
		TNT1 A 1
		TNT1 A 0 A_CustomMissile("ShellCasing",0,0,random(-80,-100),2,random(45,80))
		TNT1 A 0
		Stop
	}
}

ACTOR ShellCasing : BulletCasing
{
   Scale 0.26
   SeeSound "casings/shell/bounce"
   States
   {

   Spawn:
      SCAS A 0 A_CustomMissile("CasingSmoketrail",0,0,0)
      SCAS ABCDEFGH 1
      Loop
   Death:
	  TNT1 A 0 A_jump(256,"DeadCase1","DeadCase2","DeadCase3","DeadCase4","DeadCase5","DeadCase6")
   DeadCase1:
           SHDY A 350
		   SHDY AAAAAAAAAAA 1 A_FadeOut
           stop
   DeadCase2:
           SHDY B 350
		   SHDY BBBBBBBBBBB 1 A_FadeOut
           stop
   DeadCase3:
           SHDY C 350
		   SHDY CCCCCCCCCCC 1 A_FadeOut
           stop
   DeadCase4:
           SHDY D 350
		   SHDY DDDDDDDDDDD 1 A_FadeOut
           stop
   DeadCase5:
           SHDY E 350
		   SHDY EEEEEEEEEEE 1 A_FadeOut
           stop
   DeadCase6:
           SHDY F 350
		   SHDY FFFFFFFFFFF 1 A_FadeOut
           stop
   }
}

ACTOR ShotgunCasingSpawner2 : CasingSpawner
{
	States
	{
	Spawn:
		TNT1 A 0
		TNT1 A 1
		TNT1 A 0 A_CustomMissile("ShellCasing2",0,0,random(-80,-100),2,random(45,80))
		TNT1 A 0
		Stop
	}
}

ACTOR ShellCasing2 : ShellCasing //Used for the Firestick
{
   States
   {

   Spawn:
      SCS2 A 0 A_CustomMissile("CasingSmoketrail",0,0,0)
      SCS2 ABCDEFGH 1
      Loop
   Death:
         TNT1 A 0 A_jump(256,"DeadCase1","DeadCase2","DeadCase3","DeadCase4","DeadCase5","DeadCase6")
	DeadCase1:
           SDY2 A 350
		   SDY2 AAAAAAAAAAA 1 A_FadeOut
           stop
	DeadCase2:
           SDY2 B 350
		   SDY2 BBBBBBBBBBB 1 A_FadeOut
           stop
	DeadCase3:
           SDY2 C 350
		   SDY2 CCCCCCCCCCC 1 A_FadeOut
           stop
	DeadCase4:
           SDY2 D 350
		   SDY2 DDDDDDDDDDD 1 A_FadeOut
           stop
	DeadCase5:
           SDY2 E 350
		   SDY2 EEEEEEEEEEE 1 A_FadeOut
           stop
	DeadCase6:
           SDY2 F 350
		   SDY2 FFFFFFFFFFF 1 A_FadeOut
           stop
   }
}

ACTOR RifleCasingSpawner : CasingSpawner
{
	States
	{
	Spawn:
		TNT1 A 0
		TNT1 A 1
		TNT1 A 0 A_CustomMissile("RifleCasing",0,0,random(-80,-100),2,random(45,80))
		TNT1 A 0
		Stop
	}
}

ACTOR RifleCasing : BulletCasing
{
   Scale 0.26
   SeeSound "casings/rifle/bounce"
   States
   {

   Spawn:
      RCAS A 0 A_CustomMissile("CasingSmoketrail",0,0,0)
      RCAS ABCDEFGH 1
      Loop
   Death:
	  TNT1 A 0 A_jump(256,"DeadCase1","DeadCase2","DeadCase3","DeadCase4","DeadCase5")
   DeadCase1:
           RCAS I 350
		   RCAS IIIIIIIIIII 1 A_FadeOut
           stop
   DeadCase2:
           RCAS J 350
		   RCAS JJJJJJJJJJJ 1 A_FadeOut
           stop
   DeadCase3:
           RCAS K 350
		   RCAS KKKKKKKKKKK 1 A_FadeOut
           stop
   DeadCase4:
           RCAS L 350
		   RCAS LLLLLLLLLLL 1 A_FadeOut
           stop
   DeadCase5:
           RCAS M 350
		   RCAS MMMMMMMMMMM 1 A_FadeOut
           stop
   }
}

ACTOR CasingSmoketrail 
{
   Speed 2
   Height 2
   Radius 4
   PROJECTILE
   +NOGRAVITY
   Scale 0.25
   RenderStyle Add
   Alpha 0.2
   States
   {
   Spawn:
      SMOK A 0
	  TNT1 A 0 A_JumpIf(CallACS("NoSmoke")==1, "NoThankYou")
      goto death       
   Death: 
      SMOK ABCDEFGHIJKLMNOPQR 1
      STOP
   NoThankYou:
	  TNT1 A 0
	  Stop
   }
}

ACTOR GrenadeSmoke
{   
   Radius 0
   Height 1
   Speed 0
   Projectile
   Scale 0.75
   Renderstyle Translucent
   Alpha 0.45
   States
   {
   Spawn:
	  TNT1 A 0
	  TNT1 A 0 A_JumpIf(CallACS("NoSmoke")==1, "NoThankYou")
      NULL A 3 bright
      SMK2 ABCDE 2 Bright
      Stop 
   NoThankYou:
	  TNT1 A 0
	  Stop
   }
}

Actor ExplosionSpawner
{
	+NOINTERACTION
	States
	{
	Spawn:
		TNT1 A 0 A_Quake(4,12,0,400)
		TNT1 A 0 A_Quake(2,12,0,800)
		TNT1 A 0 A_Explode(175,148)
		TNT1 A 0 A_SpawnItemEx("RandomExplosionPicker")
		TNT1 A 0 A_JumpIf(CallACS("LessBoomEffects")==1, "JustTheFlarePlease")
		TNT1 A 0 A_SpawnItem("ExplosionShockwave")
		TNT1 AAAAA 0 A_SpawnDebris("ExplosionFlame",0,3)
		TNT1 A 9
		TNT1 A 0 A_SpawnItem("ExplosionSmoke")
		TNT1 A 30
		Stop
	JustTheFlarePlease:
		TNT1 A 39
		Stop
	}
}

ACTOR NewExplosion
{
	RenderStyle "Add"
	+NOINTERACTION
	+CLIENTSIDEONLY
	+FORCEXYBILLBOARD
	+NOBLOCKMAP
	+DONTSPLASH
	+THRUACTORS
	+NOTRIGGER
	+NOBLOCKMONST
	+NOTONAUTOMAP
	+CANNOTPUSH
	Radius 0.5
	Height 1
	Gravity 0.66
	+BRIGHT
	Alpha 0.99
	Scale 1.5
	DamageType "GMIDExplosion"
	States
	{
	Spawn:
		ZXPL ABCDEFGHIJKLMN 3
		Stop
	}
}

ACTOR NewExplosion2 : NewExplosion
{
	Scale 1.6640625
	States
	{
	Spawn:
		YXPL ABCDEFGHIJKLMNOPQ 3
		Stop
	}
}

ACTOR NewExplosion3 : NewExplosion
{
	Scale 1.25
	States
	{
	Spawn:
		XXPL ABCDEFGHIJKLMNOPQ 3
		Stop
	}
}

ACTOR NewExplosion4 : NewExplosion
{
	Scale 0.9867
	States
	{
	Spawn:
		WXPL ABCDEFGHIJK 3
		Stop
	}
}

ACTOR ExplosionSmoke : NewExplosion
{
	RenderStyle "Shaded"
	-BRIGHT
	Alpha 1.0
	States
	{
	Spawn:
		SMK0 ABCDEFGHIJKLMNO 3
		Stop
	}
}

Actor ExplosionShockwave
{
  +BRIGHT
  +NOINTERACTION
  +FORCEXYBILLBOARD
  States
  {
  Spawn:
	SHOK A 1 Bright
	TNT1 A 0 A_SetScale(1.5)
	TNT1 A 0 A_FadeOut(0.1)
	SHOK A 1 Bright
	TNT1 A 0 A_SetScale(2)
	TNT1 A 0 A_FadeOut(0.1)
	SHOK A 1 Bright
	TNT1 A 0 A_SetScale(2.5)
	TNT1 A 0 A_FadeOut(0.1)
	SHOK A 1 Bright
	TNT1 A 0 A_SetScale(3)
	TNT1 A 0 A_FadeOut(0.1)
	SHOK A 1 Bright
	TNT1 A 0 A_SetScale(3.5)
	TNT1 A 0 A_FadeOut(0.1)
	SHOK A 1 Bright
	TNT1 A 0 A_SetScale(4)
	TNT1 A 0 A_FadeOut(0.1)
	SHOK A 1 Bright
	TNT1 A 0 A_SetScale(4.5)
	TNT1 A 0 A_FadeOut(0.1)
	SHOK A 1 Bright
	TNT1 A 0 A_SetScale(5)
	TNT1 A 0 A_FadeOut(0.1)
	SHOK A 1 Bright
	TNT1 A 0 A_SetScale(5.5)
	TNT1 A 0 A_FadeOut(0.1)
	SHOK A 1 Bright
	Stop
  }
}

Actor ExplosionFlame
{
  Health 1
  Radius 8
  Height 1
  Mass 1
  Projectile
  +NOTELEPORT
  +NOBLOCKMAP
  -NOGRAVITY
  States
  {
  Spawn:
	TNT1 A 0
	TNT1 A 1 A_SpawnItem("ExplosionFlameTrail")
	Loop
  Death:
	TNT1 A 1
	Stop
  }
}

Actor ExplosionFlameTrail
{
  Mass 1
  Scale 0.3
  Alpha 0.9
  RenderStyle Add
  +NOGRAVITY
  +NOTELEPORT
  +NOBLOCKMAP
  +FORCEXYBILLBOARD
  States
  {
  Spawn:   
    SFIR ABCDEFGH 2 bright
    Stop
  }
}

ACTOR BarrelParts
{
   Radius 2
   Height 2
   Speed 0
   Damage 0
   Scale 0.3
   ReactionTime 2
   SeeSound ""
   PROJECTILE
   -NOGRAVITY
   +HEXENBOUNCE
   Scale 0.75
   BounceSound "metal/hit"
   DeathSound "metal/hit"
   States
   {
   Spawn:
	  TNT1 A 0
	  TNT1 A 0 A_JumpIf(CallACS("NoDebris")==1, "NoThankYou")
      TNT1 A 0 A_Countdown
      BARF AABBCCDDEE 2
      TNT1 A 0 A_Jump(128,2)
      TNT1 A 0 A_Countdown
      BARF FFGGHHIIJJ 2
      Loop
   Death:
      TNT1 A 1 A_SpawnItemEx("BarrelPartsDrop",0,0,0,0,0,0,128,0,0)
      Stop
   NoThankYou:
	  TNT1 A 0
	  Stop
   }
}

ACTOR BarrelPartsDrop
{
	+NOCLIP
	Scale 0.75
	States
	{
	Spawn:
		TNT1 A 0
		TNT1 A 0 A_SetTranslucent(1,0)
		TNT1 A 0 A_Jump(255,"BARFA","BARFB","BARFC","BARFD","BARFE","BARFF","BARFG","BARFH","BARFI","BARFJ")
	BARFA:
		BARF A 200
		BARF A 1 A_FadeOut(0.01)
		Wait
	BARFB:
		BARF B 200
		BARF B 1 A_FadeOut(0.01)
		Wait
	BARFC:
		BARF C 200
		BARF C 1 A_FadeOut(0.01)
		Wait
	BARFD:
		BARF D 200
		BARF D 1 A_FadeOut(0.01)
		Wait
	BARFE:
		BARF E 200
		BARF E 1 A_FadeOut(0.01)
		Wait
	BARFF:
		BARF F 200
		BARF F 1 A_FadeOut(0.01)
		Wait
	BARFG:
		BARF G 200
		BARF G 1 A_FadeOut(0.01)
		Wait
	BARFH:
		BARF H 200
		BARF H 1 A_FadeOut(0.01)
		Wait
	BARFI:
		BARF I 200
		BARF I 1 A_FadeOut(0.01)
		Wait
	BARFJ:
		BARF J 200
		BARF J 1 A_FadeOut(0.01)
		Wait
	}
}

ACTOR NewTeleportFog : TeleportFog replaces TeleportFog
{
  States
  {
  Spawn:
    TFOG ABABABABABABABABABABABCDEFGHIJ 1 Bright
    Stop
  }
}

ACTOR NewItemFog : ItemFog replaces ItemFog
{
  Scale 0.66
  States
  {
  Spawn:
    IFOG ABABABABABABABABCDEFGHIJ 1 Bright
    Stop
  }
}

ACTOR MudChunk
{
	Radius 2
	Height 4
	+NOBLOCKMAP 
	+MISSILE 
	+DROPOFF
	+NOTELEPORT
	+LOWGRAVITY
	+CANNOTPUSH
	+DONTSPLASH
	States
	{
	Spawn:
		MUDS ABCD 8
		Stop
	Death:
		MUDS D 6
		Stop
	}
}

ACTOR MudSplash
{
	+NOBLOCKMAP
	+NOCLIP
	+NOGRAVITY
	+DONTSPLASH
	States
	{
	Spawn:
		MUDS EFGH 6
		Stop
	}
}